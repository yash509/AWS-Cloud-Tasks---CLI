Step 1: Create the Public VPC:-

aws ec2 create-vpc \
  --cidr-block 10.0.0.0/16 \
  --tag-specifications 'ResourceType=vpc,Tags=[{Key=Name,Value=<vpc-name>}]' \
  --region us-east-1



Step 2: Create an Internet Gateway and Attach to VPC:-

aws ec2 create-internet-gateway \
  --tag-specifications 'ResourceType=internet-gateway,Tags=[{Key=Name,Value=<igw-name>}]' \
  --region us-east-1
  
aws ec2 describe-internet-gateways \
  --filters "Name=tag:Name,Values=<igw-name>" \
  --region us-east-1

aws ec2 attach-internet-gateway \
  --internet-gateway-id igw-xxxxxxxxxxxxxxx \
  --vpc-id vpc-xxxxxxxxxxxxxxx \
  --region us-east-1



Step 3: Create a Public Subnet with Auto-Assign Public IP:-

aws ec2 create-subnet \
  --vpc-id vpc-xxxxxxxxxxxxxxx \
  --cidr-block 10.0.1.0/24 \
  --availability-zone us-east-1a \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=<subnet-name>}]' \
  --region us-east-1

# Enable auto-assign public IP
aws ec2 modify-subnet-attribute \
  --subnet-id subnet-xxxxxxxxxxxxxxx \
  --map-public-ip-on-launch \
  --region us-east-1
  
  
  
Step 4: Create a Route Table and Associate with Subnet:-

aws ec2 create-route-table \
  --vpc-id vpc-xxxxxxxxxxxxxxx \
  --tag-specifications 'ResourceType=route-table,Tags=[{Key=Name,Value=<route-table-name>}]' \
  --region us-east-1

aws ec2 associate-route-table \
  --route-table-id rtb-xxxxxxxxxxxxxxx \
  --subnet-id subnet-xxxxxxxxxxxxxxx \
  --region us-east-1

aws ec2 create-route \
  --route-table-id rtb-xxxxxxxxxxxxxxx \
  --destination-cidr-block 0.0.0.0/0 \
  --gateway-id igw-xxxxxxxxxxxxxxx \
  --region us-east-1



Step 5: Create Security Group Allowing SSH:-

aws ec2 create-security-group \
  --group-name datacenter-pub-sg \
  --description "Allow SSH access" \
  --vpc-id vpc-xxxxxxxxxxxxxxx \
  --region us-east-1

aws ec2 authorize-security-group-ingress \
  --group-id sg-xxxxxxxxxxxxxxx \
  --protocol tcp \
  --port 22 \
  --cidr 0.0.0.0/0 \
  --region us-east-1



Step 6: Create Key Pair:-

aws ec2 create-key-pair \
  --key-name devops-kp \
  --key-type rsa \
  --query 'KeyMaterial' \
  --output text > devops-kp.pem



Step 7: Launch EC2 Instance in Public Subnet:

aws ec2 run-instances \
  --image-id ami-0030e4319cbf4dbf2 \   
  --count 1 \
  --instance-type t2.micro \
  --key-name devops-kp \
  --security-group-ids sg-xxxxxxxxxxxxxxx \
  --subnet-id subnet-xxxxxxxxxxxxxxx \
  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=datacenter-pub-ec2}]' \
  --region us-east-1
  


Step 8: Verification Steps:-

ðŸ”Ž Verify VPC and Subnet ->

aws ec2 describe-vpcs \
  --filters "Name=tag:Name,Values=datacenter-pub-vpc" \
  --region us-east-1
Check the subnet exists and auto-assigns public IPs:

aws ec2 describe-subnets \
  --filters "Name=tag:Name,Values=datacenter-pub-subnet" \
  --region us-east-1 \
  --query "Subnets[*].MapPublicIpOnLaunch"
  
Output should be true â†’ confirms auto-assign public IP is enabled.

ðŸ”Ž Verify Internet Gateway and Routing ->

Check Internet Gateway is attached:

aws ec2 describe-internet-gateways \
  --filters "Name=attachment.vpc-id,Values=vpc-xxxxxxxxxxxxxxx" \
  --region us-east-1
  
Check route table has a default route (0.0.0.0/0) to IGW:


aws ec2 describe-route-tables \
  --filters "Name=vpc-id,Values=vpc-xxxxxxxxxxxxxxx" \
  --region us-east-1
  
Look for a route entry with DestinationCidrBlock: 0.0.0.0/0 and GatewayId: igw-xxxxxxxx.

ðŸ”Ž Verify Security Group ->

Check SSH port (22) is open:

aws ec2 describe-security-groups \
  --group-ids sg-xxxxxxxxxxxxxxx \
  --region us-east-1

Ensure inbound rules include tcp, port 22, 0.0.0.0/0.

ðŸ”Ž Verify EC2 Instance ->

Check instance is running and has a public IP:

aws ec2 describe-instances \
  --filters "Name=tag:Name,Values=datacenter-pub-ec2" \
  --region us-east-1 \
  --query "Reservations[*].Instances[*].[InstanceId,State.Name,PublicIpAddress]"
